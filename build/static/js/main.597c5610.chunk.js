(this.webpackJsonptodolist=this.webpackJsonptodolist||[]).push([[0],{101:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(21),c=a.n(s),o=a(6),i=a(2),d=a(54);function u(e,t){switch(t.type){case"CREATE_TODO":return[{title:t.data.title,description:t.data.description,dateCompleted:t.data.dateCompleted,dateCreated:t.data.dateCreated,_id:t.data.id,author:t.data.author}].concat(Object(d.a)(e));case"TOGGLE_TODO":return e.map((function(e){return e._id===t.id?Object(i.a)(Object(i.a)({},e),{},{dateCompleted:e.dateCompleted?"":(new Date).toLocaleDateString("en-us")}):e}));case"DELETE_TODO":return e.filter((function(e){return e._id!==t.id}));case"FETCH_TODOS":return t.todoItems;default:return e}}function j(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function l(e,t){return{userInfo:j(e.userInfo,t),todoItems:u(e.todoItems,t)}}var b=a(8),O=a(11),h=a(109),f=a(107),p=a(104),x=a(1);function m(e){var t=e.show,a=e.handleClose,r=Object(n.useContext)(b.a).dispatch,s=Object(n.useState)(""),c=Object(o.a)(s,2),i=c[0],d=c[1],u=Object(n.useState)(""),j=Object(o.a)(u,2),l=j[0],m=j[1],g=Object(n.useState)(!1),v=Object(o.a)(g,2),C=v[0],w=v[1];var y=Object(O.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),L=Object(o.a)(y,2),E=L[0],T=L[1];return Object(n.useEffect)((function(){E&&!1===E.isLoading&&(E.data||E.error)&&(E.error?(w(!0),alert("failed")):(w(!1),console.log(E.data),r({type:"LOGIN",username:i,access_token:E.data.access_token})))}),[E]),Object(x.jsx)(h.a,{show:t,onHide:a,children:Object(x.jsxs)(f.a,{onSubmit:function(e){e.preventDefault(),T(i,l),a()},children:[Object(x.jsx)(h.a.Header,{closeButton:!0,children:Object(x.jsx)(h.a.Title,{children:"Login"})}),Object(x.jsxs)(h.a.Body,{children:[Object(x.jsx)(f.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(x.jsx)(f.a.Control,{type:"text",value:i,onChange:function(e){d(e.target.value)},name:"login-username",id:"login-username"}),Object(x.jsx)(f.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(x.jsx)(f.a.Control,{type:"password",value:l,onChange:function(e){m(e.target.value)},name:"login-password",id:"login-password"}),C&&Object(x.jsx)(f.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(x.jsxs)(h.a.Footer,{children:[Object(x.jsx)(p.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(x.jsx)(p.a,{variant:"primary",disabled:0===i.length,type:"submit",children:"Login"})]})]})})}a(96);function g(e){var t=e.show,a=e.handleClose,r=Object(n.useContext)(b.a).dispatch,s=Object(n.useState)({username:"",password:"",passwordRepeat:""}),c=Object(o.a)(s,2),d=c[0],u=c[1],j=Object(n.useState)(""),l=Object(o.a)(j,2),m=(l[0],l[1]),g=Object(O.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),v=Object(o.a)(g,2),C=v[0],w=v[1];return Object(n.useEffect)((function(){C&&C.data&&r({type:"REGISTER",username:C.data.username,access_token:C.data.access_token})}),[C]),Object(n.useEffect)((function(){C&&!1===C.isLoading&&(C.data||C.error)&&(C.error?(console.log(C),m("Registration failed, please try again later."),alert("fail")):(console.log(C),m("Registration successful. You may now login."),alert("success")))}),[C]),Object(x.jsx)(h.a,{show:t,onHide:a,children:Object(x.jsxs)(f.a,{onSubmit:function(e){e.preventDefault(),w(d.username,d.password),a()},children:[Object(x.jsx)(h.a.Header,{closeButton:!0,children:Object(x.jsx)(h.a.Title,{children:"Register"})}),Object(x.jsxs)(h.a.Body,{children:[Object(x.jsx)(f.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(x.jsx)(f.a.Control,{type:"text",value:d.username,onChange:function(e){return u(Object(i.a)(Object(i.a)({},d),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(x.jsx)(f.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(x.jsx)(f.a.Control,{type:"password",name:"register-password",id:"register-password",value:d.password,onChange:function(e){return u(Object(i.a)(Object(i.a)({},d),{},{password:e.target.value}))}}),Object(x.jsx)(f.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(x.jsx)(f.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:d.passwordRepeat,onChange:function(e){return u(Object(i.a)(Object(i.a)({},d),{},{passwordRepeat:e.target.value}))}})]}),Object(x.jsxs)(h.a.Footer,{children:[Object(x.jsx)(p.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(x.jsx)(p.a,{variant:"primary",type:"submit",disabled:0===d.username.length||0===d.password.length||d.password!==d.passwordRepeat,children:"Register"})]})]})})}function v(e){var t=e.show,a=e.handleClose,r=Object(n.useContext)(b.a),s=r.state,c=r.dispatch,i=s.userInfo,d=Object(O.b)((function(e){var t=e.title,a=e.description,n=e.dateCreated,r=e.dateCompleted;return{url:"/todo",method:"post",headers:{Authorization:"".concat(i.access_token)},data:{title:t,description:a,dateCreated:n,dateCompleted:r}}})),u=Object(o.a)(d,2),j=u[0],l=u[1];Object(n.useEffect)((function(){j&&j.data&&c({type:"CREATE_TODO",data:j.data})}),[j.data]);var m=Object(n.useState)(""),g=Object(o.a)(m,2),v=g[0],C=g[1],w=Object(n.useState)(""),y=Object(o.a)(w,2),L=y[0],E=y[1];return Object(x.jsx)(h.a,{show:t,onHide:a,children:Object(x.jsxs)(f.a,{onSubmit:function(e){e.preventDefault(),function(){var e=(new Date).toLocaleDateString("en-us");l({title:v,description:L,dateCreated:e,dateCompleted:""})}(),a()},children:[Object(x.jsx)(h.a.Header,{closeButton:!0,children:Object(x.jsx)(h.a.Title,{children:"Create New Todo"})}),Object(x.jsxs)(h.a.Body,{children:[Object(x.jsx)(f.a.Label,{htmlFor:"create-title",children:"Title:"}),Object(x.jsx)(f.a.Control,{type:"text",value:v,onChange:function(e){C(e.target.value)},name:"create-title",id:"create-title",required:!0}),Object(x.jsx)(f.a.Label,{htmlFor:"description",children:"Description:"}),Object(x.jsx)("textarea",{value:L,onChange:function(e){E(e.target.value)},className:"form-control",rows:"5"})]}),Object(x.jsxs)(h.a.Footer,{children:[Object(x.jsx)(p.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(x.jsx)(p.a,{variant:"primary",disabled:0===v.length,type:"submit",children:"Create"})]})]})})}var C=a(27);function w(){var e=r.a.lazy((function(){return Promise.resolve().then(a.bind(null,96))})),t=Object(n.useContext)(b.a).state,s=Object(n.useState)(!1),c=Object(o.a)(s,2),i=c[0],d=c[1],u=Object(n.useState)(!1),j=Object(o.a)(u,2),l=j[0],O=j[1],h=Object(n.useState)(!1),f=Object(o.a)(h,2),w=f[0],y=f[1];return t.userInfo.username?Object(x.jsxs)("div",{className:"justify-content-end",children:[Object(x.jsx)(p.a,{variant:"link",onClick:function(e){return y(!0)},children:"Create New Post"}),Object(x.jsx)(v,{show:w,handleClose:function(){return y(!1)}}),Object(x.jsx)(C.a,{href:"/users",children:" See All Users "}),Object(x.jsx)(e,{})]}):Object(x.jsxs)("div",{className:"justify-content-end",children:[Object(x.jsx)(p.a,{variant:"link",onClick:function(e){return d(!0)},children:"Login"}),Object(x.jsx)(m,{show:i,handleClose:function(){return d(!1)}}),Object(x.jsx)(p.a,{variant:"link",onClick:function(e){return O(!0)},children:"Register"}),Object(x.jsx)(g,{show:l,handleClose:function(){return O(!1)}})]})}var y=a(108),L=a(105),E=a(106);function T(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(y.a,{bg:"light",expand:"lg",children:Object(x.jsxs)(L.a,{children:[Object(x.jsx)(y.a.Brand,{href:"/",children:"TODO LIST"}),Object(x.jsx)(y.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(x.jsxs)(y.a.Collapse,{id:"basic-navbar-nav",children:[Object(x.jsx)(E.a,{className:"me-auto"}),Object(x.jsx)(r.a.Suspense,{fallback:"Loading...",children:Object(x.jsx)(w,{})})]})]})})})}function k(e){var t=e.title,a=e.description,r=e.dateCreated,s=e.dateCompleted,c=e._id,i=(e.userId,Object(n.useContext)(b.a)),d=i.state,u=i.dispatch,j=d.userInfo,l=Object(O.b)((function(e){return{url:"/todo",method:"delete",headers:{Authorization:"".concat(j.access_token)},data:{_id:e}}})),h=Object(o.a)(l,2),f=h[0],p=h[1];Object(n.useEffect)((function(){f&&f.data&&!1===f.isLoading&&(console.log(c),u({type:"DELETE_TODO",id:c}))}),[,f]);var m=Object(O.b)((function(e,t){return{url:"/todo",method:"patch",headers:{Authorization:"".concat(j.access_token)},data:{_id:e,dateCompleted:t}}})),g=Object(o.a)(m,2),v=g[0],C=g[1];return Object(n.useEffect)((function(){v&&v.data&&!1===v.isLoading&&u({type:"TOGGLE_TODO",id:c})}),[,v]),Object(x.jsxs)("div",{children:[Object(x.jsx)("h3",{children:t}),Object(x.jsx)("div",{children:Object(x.jsx)("i",{children:a})}),Object(x.jsxs)("div",{children:["Created on : ",r||(new Date).toLocaleDateString("en-us")]}),Object(x.jsx)("div",{children:"Date completed:".concat(s)}),Object(x.jsxs)("label",{children:["Complete:",Object(x.jsx)("input",{type:"checkbox",checked:!!s,onChange:function(e){C(c,s)}})]}),Object(x.jsx)("br",{}),Object(x.jsx)("button",{onClick:function(e){p(c)},children:"Delete"})]})}function I(){var e=Object(n.useContext)(b.a).state.todoItems;return Object(x.jsx)("div",{children:e.map((function(e,t){return Object(n.createElement)(k,Object(i.a)(Object(i.a)({},e),{},{key:"todo-"+t}))}))})}function _(){var e=Object(n.useContext)(b.a).dispatch,t=Object(O.b)((function(){return{url:"/todo/all",method:"get"}})),a=Object(o.a)(t,2),r=a[0],s=a[1];Object(n.useEffect)(s,[]),Object(n.useEffect)((function(){r&&r.data&&e({type:"FETCH_TODOS",todoItems:r.data.todos.reverse()})}),[r]);var c=r.isLoading;return Object(x.jsxs)(x.Fragment,{children:[c&&"Posts loading..."," ",Object(x.jsx)(I,{})]})}function S(){var e=Object(O.b)((function(){return{url:"/auth/users",method:"get"}})),t=Object(o.a)(e,2),a=t[0],r=t[1];Object(n.useEffect)(r,[]);var s=a.data,c=a.isLoading;return Object(x.jsxs)("div",{children:[c&&" Loading users...",s&&s.users.map((function(e,t){return Object(x.jsxs)(C.a,{href:"/users/".concat(e._id),children:[" ",e.username," "]},"userList-"+t)}))]})}var D=a(9);function R(e){var t=e.userId,a=Object(n.useContext)(b.a).state,r=a.todoItems;return Object(x.jsxs)(x.Fragment,{children:[console.log(a),r&&r.filter((function(e){return e.author===t})).map((function(e,t){return Object(n.createElement)(k,Object(i.a)(Object(i.a)({},e),{},{key:"todoUser-"+t}))}))]})}a(100);var F=function(){var e=Object(n.useReducer)(l,{userInfo:{},todoItems:[]}),t=Object(o.a)(e,2),a=t[0],r=t[1],s=Object(D.f)({"/":Object(D.g)({view:Object(x.jsx)(_,{})}),"/users":Object(D.g)({view:Object(x.jsx)(S,{})}),"/users/:userId":Object(D.g)((function(e){return{view:Object(x.jsx)(R,{userId:e.params.userId})}}))});return Object(x.jsx)("div",{className:"App",children:Object(x.jsx)(b.a.Provider,{value:{state:a,dispatch:r},children:Object(x.jsx)(C.b,{routes:s,children:Object(x.jsxs)(L.a,{children:[Object(x.jsx)(T,{}),Object(x.jsx)("hr",{}),Object(x.jsx)(C.c,{})]})})})})},G=a(36),N=a.n(G).a.create({baseURL:"/"});c.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(O.a,{value:N,children:Object(x.jsx)(F,{})})}),document.getElementById("root"))},8:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),r=a.n(n).a.createContext({state:{username:"",access_token:""},dispatch:function(){}})},96:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return c}));var n=a(0),r=a(8),s=a(1);function c(){var e=Object(n.useContext)(r.a),t=e.state,a=e.dispatch,c=t.userInfo.username;return Object(s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a({type:"LOGOUT"})},children:["Logged in as: ",Object(s.jsx)("b",{children:c}),Object(s.jsx)("input",{type:"submit",value:"Logout"})]})}}},[[101,1,2]]]);
//# sourceMappingURL=main.597c5610.chunk.js.map